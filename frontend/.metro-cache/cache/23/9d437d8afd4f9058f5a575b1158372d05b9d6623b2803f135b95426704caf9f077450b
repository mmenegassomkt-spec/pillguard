{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":57,"index":57}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":58},"end":{"line":2,"column":69,"index":127}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-store-review","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":128},"end":{"line":3,"column":49,"index":177}}],"key":"yzkhvrxknPFq6IkeOqtXxybOttw=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"useReviewPrompt\", {\n    enumerable: true,\n    get: function () {\n      return useReviewPrompt;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _expoStoreReview = require(_dependencyMap[2], \"expo-store-review\");\n  var StoreReview = _interopNamespace(_expoStoreReview);\n  const STORAGE_KEYS = {\n    FIRST_USE_DATE: '@pillguard_first_use_date',\n    REVIEW_COMPLETED: '@pillguard_review_completed',\n    NEXT_REVIEW_DATE: '@pillguard_next_review_date'\n  };\n  const DAYS_BEFORE_FIRST_REVIEW = 15;\n  const DAYS_BEFORE_RETRY = 30;\n  const useReviewPrompt = () => {\n    const [shouldShowReview, setShouldShowReview] = (0, _react.useState)(false);\n    (0, _react.useEffect)(() => {\n      checkReviewEligibility();\n    }, []);\n    const checkReviewEligibility = async () => {\n      try {\n        // Verificar se já avaliou\n        const reviewCompleted = await AsyncStorage.default.getItem(STORAGE_KEYS.REVIEW_COMPLETED);\n        if (reviewCompleted === 'true') {\n          return; // Nunca mais mostrar\n        }\n\n        // Verificar primeira data de uso\n        let firstUseDate = await AsyncStorage.default.getItem(STORAGE_KEYS.FIRST_USE_DATE);\n        if (!firstUseDate) {\n          // Primeira vez usando o app\n          firstUseDate = new Date().toISOString();\n          await AsyncStorage.default.setItem(STORAGE_KEYS.FIRST_USE_DATE, firstUseDate);\n          return; // Ainda não é hora de pedir avaliação\n        }\n\n        // Verificar se há data de próxima avaliação agendada\n        const nextReviewDate = await AsyncStorage.default.getItem(STORAGE_KEYS.NEXT_REVIEW_DATE);\n        const now = new Date();\n        if (nextReviewDate) {\n          // Usuário recusou antes, verificar se já passou o tempo\n          const nextDate = new Date(nextReviewDate);\n          if (now >= nextDate) {\n            setShouldShowReview(true);\n          }\n        } else {\n          // Verificar se já passaram 15 dias desde o primeiro uso\n          const firstDate = new Date(firstUseDate);\n          const daysSinceFirstUse = Math.floor((now.getTime() - firstDate.getTime()) / (1000 * 60 * 60 * 24));\n          if (daysSinceFirstUse >= DAYS_BEFORE_FIRST_REVIEW) {\n            setShouldShowReview(true);\n          }\n        }\n      } catch (error) {\n        console.error('Error checking review eligibility:', error);\n      }\n    };\n    const handleReviewAccepted = (0, _react.useCallback)(async () => {\n      try {\n        // Marcar como avaliado permanentemente\n        await AsyncStorage.default.setItem(STORAGE_KEYS.REVIEW_COMPLETED, 'true');\n        setShouldShowReview(false);\n\n        // Tentar abrir a avaliação nativa da loja\n        if (await StoreReview.isAvailableAsync()) {\n          await StoreReview.requestReview();\n        }\n      } catch (error) {\n        console.error('Error handling review:', error);\n      }\n    }, []);\n    const handleReviewDeclined = (0, _react.useCallback)(async () => {\n      try {\n        // Agendar para 30 dias depois\n        const nextDate = new Date();\n        nextDate.setDate(nextDate.getDate() + DAYS_BEFORE_RETRY);\n        await AsyncStorage.default.setItem(STORAGE_KEYS.NEXT_REVIEW_DATE, nextDate.toISOString());\n        setShouldShowReview(false);\n      } catch (error) {\n        console.error('Error scheduling next review:', error);\n      }\n    }, []);\n    const dismissReview = (0, _react.useCallback)(() => {\n      setShouldShowReview(false);\n    }, []);\n\n    // Para testes: resetar o estado de avaliação\n    const resetReviewState = async () => {\n      await AsyncStorage.default.multiRemove([STORAGE_KEYS.FIRST_USE_DATE, STORAGE_KEYS.REVIEW_COMPLETED, STORAGE_KEYS.NEXT_REVIEW_DATE]);\n    };\n    return {\n      shouldShowReview,\n      handleReviewAccepted,\n      handleReviewDeclined,\n      dismissReview,\n      resetReviewState\n    };\n  };\n});","lineCount":129,"map":[[27,2,15,0,"Object"],[27,8,15,0],[27,9,15,0,"defineProperty"],[27,23,15,0],[27,24,15,0,"exports"],[27,31,15,0],[28,4,15,0,"enumerable"],[28,14,15,0],[29,4,15,0,"get"],[29,7,15,0],[29,18,15,0,"get"],[29,19,15,0],[30,6,15,0],[30,13,15,0,"useReviewPrompt"],[30,28,15,0],[31,4,15,0],[32,2,15,0],[33,2,1,0],[33,6,1,0,"_react"],[33,12,1,0],[33,15,1,0,"require"],[33,22,1,0],[33,23,1,0,"_dependencyMap"],[33,37,1,0],[34,2,2,0],[34,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[34,42,2,0],[34,45,2,0,"require"],[34,52,2,0],[34,53,2,0,"_dependencyMap"],[34,67,2,0],[35,2,2,0],[35,6,2,0,"AsyncStorage"],[35,18,2,0],[35,21,2,0,"_interopDefault"],[35,36,2,0],[35,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[35,73,2,0],[36,2,3,0],[36,6,3,0,"_expoStoreReview"],[36,22,3,0],[36,25,3,0,"require"],[36,32,3,0],[36,33,3,0,"_dependencyMap"],[36,47,3,0],[37,2,3,0],[37,6,3,0,"StoreReview"],[37,17,3,0],[37,20,3,0,"_interopNamespace"],[37,37,3,0],[37,38,3,0,"_expoStoreReview"],[37,54,3,0],[38,2,6,0],[38,8,6,6,"STORAGE_KEYS"],[38,20,6,18],[38,23,6,21],[39,4,7,2,"FIRST_USE_DATE"],[39,18,7,16],[39,20,7,18],[39,47,7,45],[40,4,8,2,"REVIEW_COMPLETED"],[40,20,8,18],[40,22,8,20],[40,51,8,49],[41,4,9,2,"NEXT_REVIEW_DATE"],[41,20,9,18],[41,22,9,20],[42,2,10,0],[42,3,10,1],[43,2,12,0],[43,8,12,6,"DAYS_BEFORE_FIRST_REVIEW"],[43,32,12,30],[43,35,12,33],[43,37,12,35],[44,2,13,0],[44,8,13,6,"DAYS_BEFORE_RETRY"],[44,25,13,23],[44,28,13,26],[44,30,13,28],[45,2,15,7],[45,8,15,13,"useReviewPrompt"],[45,23,15,28],[45,26,15,31,"useReviewPrompt"],[45,27,15,31],[45,32,15,37],[46,4,16,2],[46,10,16,8],[46,11,16,9,"shouldShowReview"],[46,27,16,25],[46,29,16,27,"setShouldShowReview"],[46,48,16,46],[46,49,16,47],[46,52,16,50],[46,56,16,50,"useState"],[46,62,16,58],[46,63,16,58,"useState"],[46,71,16,58],[46,73,16,59],[46,78,16,64],[46,79,16,65],[47,4,18,2],[47,8,18,2,"useEffect"],[47,14,18,11],[47,15,18,11,"useEffect"],[47,24,18,11],[47,26,18,12],[47,32,18,18],[48,6,19,4,"checkReviewEligibility"],[48,28,19,26],[48,29,19,27],[48,30,19,28],[49,4,20,2],[49,5,20,3],[49,7,20,5],[49,9,20,7],[49,10,20,8],[50,4,22,2],[50,10,22,8,"checkReviewEligibility"],[50,32,22,30],[50,35,22,33],[50,41,22,33,"checkReviewEligibility"],[50,42,22,33],[50,47,22,45],[51,6,23,4],[51,10,23,8],[52,8,24,6],[53,8,25,6],[53,14,25,12,"reviewCompleted"],[53,29,25,27],[53,32,25,30],[53,38,25,36,"AsyncStorage"],[53,50,25,48],[53,51,25,48,"default"],[53,58,25,48],[53,59,25,49,"getItem"],[53,66,25,56],[53,67,25,57,"STORAGE_KEYS"],[53,79,25,69],[53,80,25,70,"REVIEW_COMPLETED"],[53,96,25,86],[53,97,25,87],[54,8,26,6],[54,12,26,10,"reviewCompleted"],[54,27,26,25],[54,32,26,30],[54,38,26,36],[54,40,26,38],[55,10,27,8],[55,17,27,15],[55,18,27,16],[56,8,28,6],[58,8,30,6],[59,8,31,6],[59,12,31,10,"firstUseDate"],[59,24,31,22],[59,27,31,25],[59,33,31,31,"AsyncStorage"],[59,45,31,43],[59,46,31,43,"default"],[59,53,31,43],[59,54,31,44,"getItem"],[59,61,31,51],[59,62,31,52,"STORAGE_KEYS"],[59,74,31,64],[59,75,31,65,"FIRST_USE_DATE"],[59,89,31,79],[59,90,31,80],[60,8,32,6],[60,12,32,10],[60,13,32,11,"firstUseDate"],[60,25,32,23],[60,27,32,25],[61,10,33,8],[62,10,34,8,"firstUseDate"],[62,22,34,20],[62,25,34,23],[62,29,34,27,"Date"],[62,33,34,31],[62,34,34,32],[62,35,34,33],[62,36,34,34,"toISOString"],[62,47,34,45],[62,48,34,46],[62,49,34,47],[63,10,35,8],[63,16,35,14,"AsyncStorage"],[63,28,35,26],[63,29,35,26,"default"],[63,36,35,26],[63,37,35,27,"setItem"],[63,44,35,34],[63,45,35,35,"STORAGE_KEYS"],[63,57,35,47],[63,58,35,48,"FIRST_USE_DATE"],[63,72,35,62],[63,74,35,64,"firstUseDate"],[63,86,35,76],[63,87,35,77],[64,10,36,8],[64,17,36,15],[64,18,36,16],[65,8,37,6],[67,8,39,6],[68,8,40,6],[68,14,40,12,"nextReviewDate"],[68,28,40,26],[68,31,40,29],[68,37,40,35,"AsyncStorage"],[68,49,40,47],[68,50,40,47,"default"],[68,57,40,47],[68,58,40,48,"getItem"],[68,65,40,55],[68,66,40,56,"STORAGE_KEYS"],[68,78,40,68],[68,79,40,69,"NEXT_REVIEW_DATE"],[68,95,40,85],[68,96,40,86],[69,8,41,6],[69,14,41,12,"now"],[69,17,41,15],[69,20,41,18],[69,24,41,22,"Date"],[69,28,41,26],[69,29,41,27],[69,30,41,28],[70,8,43,6],[70,12,43,10,"nextReviewDate"],[70,26,43,24],[70,28,43,26],[71,10,44,8],[72,10,45,8],[72,16,45,14,"nextDate"],[72,24,45,22],[72,27,45,25],[72,31,45,29,"Date"],[72,35,45,33],[72,36,45,34,"nextReviewDate"],[72,50,45,48],[72,51,45,49],[73,10,46,8],[73,14,46,12,"now"],[73,17,46,15],[73,21,46,19,"nextDate"],[73,29,46,27],[73,31,46,29],[74,12,47,10,"setShouldShowReview"],[74,31,47,29],[74,32,47,30],[74,36,47,34],[74,37,47,35],[75,10,48,8],[76,8,49,6],[76,9,49,7],[76,15,49,13],[77,10,50,8],[78,10,51,8],[78,16,51,14,"firstDate"],[78,25,51,23],[78,28,51,26],[78,32,51,30,"Date"],[78,36,51,34],[78,37,51,35,"firstUseDate"],[78,49,51,47],[78,50,51,48],[79,10,52,8],[79,16,52,14,"daysSinceFirstUse"],[79,33,52,31],[79,36,52,34,"Math"],[79,40,52,38],[79,41,52,39,"floor"],[79,46,52,44],[79,47,52,45],[79,48,52,46,"now"],[79,51,52,49],[79,52,52,50,"getTime"],[79,59,52,57],[79,60,52,58],[79,61,52,59],[79,64,52,62,"firstDate"],[79,73,52,71],[79,74,52,72,"getTime"],[79,81,52,79],[79,82,52,80],[79,83,52,81],[79,88,52,86],[79,92,52,90],[79,95,52,93],[79,97,52,95],[79,100,52,98],[79,102,52,100],[79,105,52,103],[79,107,52,105],[79,108,52,106],[79,109,52,107],[80,10,54,8],[80,14,54,12,"daysSinceFirstUse"],[80,31,54,29],[80,35,54,33,"DAYS_BEFORE_FIRST_REVIEW"],[80,59,54,57],[80,61,54,59],[81,12,55,10,"setShouldShowReview"],[81,31,55,29],[81,32,55,30],[81,36,55,34],[81,37,55,35],[82,10,56,8],[83,8,57,6],[84,6,58,4],[84,7,58,5],[84,8,58,6],[84,15,58,13,"error"],[84,20,58,18],[84,22,58,20],[85,8,59,6,"console"],[85,15,59,13],[85,16,59,14,"error"],[85,21,59,19],[85,22,59,20],[85,58,59,56],[85,60,59,58,"error"],[85,65,59,63],[85,66,59,64],[86,6,60,4],[87,4,61,2],[87,5,61,3],[88,4,63,2],[88,10,63,8,"handleReviewAccepted"],[88,30,63,28],[88,33,63,31],[88,37,63,31,"useCallback"],[88,43,63,42],[88,44,63,42,"useCallback"],[88,55,63,42],[88,57,63,43],[88,69,63,55],[89,6,64,4],[89,10,64,8],[90,8,65,6],[91,8,66,6],[91,14,66,12,"AsyncStorage"],[91,26,66,24],[91,27,66,24,"default"],[91,34,66,24],[91,35,66,25,"setItem"],[91,42,66,32],[91,43,66,33,"STORAGE_KEYS"],[91,55,66,45],[91,56,66,46,"REVIEW_COMPLETED"],[91,72,66,62],[91,74,66,64],[91,80,66,70],[91,81,66,71],[92,8,67,6,"setShouldShowReview"],[92,27,67,25],[92,28,67,26],[92,33,67,31],[92,34,67,32],[94,8,69,6],[95,8,70,6],[95,12,70,10],[95,18,70,16,"StoreReview"],[95,29,70,27],[95,30,70,28,"isAvailableAsync"],[95,46,70,44],[95,47,70,45],[95,48,70,46],[95,50,70,48],[96,10,71,8],[96,16,71,14,"StoreReview"],[96,27,71,25],[96,28,71,26,"requestReview"],[96,41,71,39],[96,42,71,40],[96,43,71,41],[97,8,72,6],[98,6,73,4],[98,7,73,5],[98,8,73,6],[98,15,73,13,"error"],[98,20,73,18],[98,22,73,20],[99,8,74,6,"console"],[99,15,74,13],[99,16,74,14,"error"],[99,21,74,19],[99,22,74,20],[99,46,74,44],[99,48,74,46,"error"],[99,53,74,51],[99,54,74,52],[100,6,75,4],[101,4,76,2],[101,5,76,3],[101,7,76,5],[101,9,76,7],[101,10,76,8],[102,4,78,2],[102,10,78,8,"handleReviewDeclined"],[102,30,78,28],[102,33,78,31],[102,37,78,31,"useCallback"],[102,43,78,42],[102,44,78,42,"useCallback"],[102,55,78,42],[102,57,78,43],[102,69,78,55],[103,6,79,4],[103,10,79,8],[104,8,80,6],[105,8,81,6],[105,14,81,12,"nextDate"],[105,22,81,20],[105,25,81,23],[105,29,81,27,"Date"],[105,33,81,31],[105,34,81,32],[105,35,81,33],[106,8,82,6,"nextDate"],[106,16,82,14],[106,17,82,15,"setDate"],[106,24,82,22],[106,25,82,23,"nextDate"],[106,33,82,31],[106,34,82,32,"getDate"],[106,41,82,39],[106,42,82,40],[106,43,82,41],[106,46,82,44,"DAYS_BEFORE_RETRY"],[106,63,82,61],[106,64,82,62],[107,8,83,6],[107,14,83,12,"AsyncStorage"],[107,26,83,24],[107,27,83,24,"default"],[107,34,83,24],[107,35,83,25,"setItem"],[107,42,83,32],[107,43,83,33,"STORAGE_KEYS"],[107,55,83,45],[107,56,83,46,"NEXT_REVIEW_DATE"],[107,72,83,62],[107,74,83,64,"nextDate"],[107,82,83,72],[107,83,83,73,"toISOString"],[107,94,83,84],[107,95,83,85],[107,96,83,86],[107,97,83,87],[108,8,84,6,"setShouldShowReview"],[108,27,84,25],[108,28,84,26],[108,33,84,31],[108,34,84,32],[109,6,85,4],[109,7,85,5],[109,8,85,6],[109,15,85,13,"error"],[109,20,85,18],[109,22,85,20],[110,8,86,6,"console"],[110,15,86,13],[110,16,86,14,"error"],[110,21,86,19],[110,22,86,20],[110,53,86,51],[110,55,86,53,"error"],[110,60,86,58],[110,61,86,59],[111,6,87,4],[112,4,88,2],[112,5,88,3],[112,7,88,5],[112,9,88,7],[112,10,88,8],[113,4,90,2],[113,10,90,8,"dismissReview"],[113,23,90,21],[113,26,90,24],[113,30,90,24,"useCallback"],[113,36,90,35],[113,37,90,35,"useCallback"],[113,48,90,35],[113,50,90,36],[113,56,90,42],[114,6,91,4,"setShouldShowReview"],[114,25,91,23],[114,26,91,24],[114,31,91,29],[114,32,91,30],[115,4,92,2],[115,5,92,3],[115,7,92,5],[115,9,92,7],[115,10,92,8],[117,4,94,2],[118,4,95,2],[118,10,95,8,"resetReviewState"],[118,26,95,24],[118,29,95,27],[118,35,95,27,"resetReviewState"],[118,36,95,27],[118,41,95,39],[119,6,96,4],[119,12,96,10,"AsyncStorage"],[119,24,96,22],[119,25,96,22,"default"],[119,32,96,22],[119,33,96,23,"multiRemove"],[119,44,96,34],[119,45,96,35],[119,46,97,6,"STORAGE_KEYS"],[119,58,97,18],[119,59,97,19,"FIRST_USE_DATE"],[119,73,97,33],[119,75,98,6,"STORAGE_KEYS"],[119,87,98,18],[119,88,98,19,"REVIEW_COMPLETED"],[119,104,98,35],[119,106,99,6,"STORAGE_KEYS"],[119,118,99,18],[119,119,99,19,"NEXT_REVIEW_DATE"],[119,135,99,35],[119,136,100,5],[119,137,100,6],[120,4,101,2],[120,5,101,3],[121,4,103,2],[121,11,103,9],[122,6,104,4,"shouldShowReview"],[122,22,104,20],[123,6,105,4,"handleReviewAccepted"],[123,26,105,24],[124,6,106,4,"handleReviewDeclined"],[124,26,106,24],[125,6,107,4,"dismissReview"],[125,19,107,17],[126,6,108,4,"resetReviewState"],[127,4,109,2],[127,5,109,3],[128,2,110,0],[128,3,110,1],[129,0,110,2],[129,3]],"functionMap":{"names":["<global>","useReviewPrompt","useEffect$argument_0","checkReviewEligibility","handleReviewAccepted","handleReviewDeclined","dismissReview","resetReviewState"],"mappings":"AAA;+BCc;YCG;GDE;iCEE;GFuC;2CGE;GHa;2CIE;GJU;oCKE;GLE;2BMG;GNM;CDS"},"hasCjsExports":false},"type":"js/module"}]}