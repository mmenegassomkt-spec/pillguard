{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":57,"index":57}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":58},"end":{"line":2,"column":69,"index":127}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-store-review","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":128},"end":{"line":3,"column":49,"index":177}}],"key":"yzkhvrxknPFq6IkeOqtXxybOttw=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"useReviewPrompt\", {\n    enumerable: true,\n    get: function () {\n      return useReviewPrompt;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _expoStoreReview = require(_dependencyMap[2], \"expo-store-review\");\n  var StoreReview = _interopNamespace(_expoStoreReview);\n  const STORAGE_KEYS = {\n    FIRST_USE_DATE: '@pillguard_first_use_date',\n    REVIEW_COMPLETED: '@pillguard_review_completed',\n    NEXT_REVIEW_DATE: '@pillguard_next_review_date'\n  };\n  const DAYS_BEFORE_FIRST_REVIEW = 15;\n  const DAYS_BEFORE_RETRY = 30;\n  const useReviewPrompt = () => {\n    _s();\n    const [shouldShowReview, setShouldShowReview] = (0, _react.useState)(false);\n    (0, _react.useEffect)(() => {\n      checkReviewEligibility();\n    }, []);\n    const checkReviewEligibility = async () => {\n      try {\n        // Verificar se já avaliou\n        const reviewCompleted = await AsyncStorage.default.getItem(STORAGE_KEYS.REVIEW_COMPLETED);\n        if (reviewCompleted === 'true') {\n          return; // Nunca mais mostrar\n        }\n\n        // Verificar primeira data de uso\n        let firstUseDate = await AsyncStorage.default.getItem(STORAGE_KEYS.FIRST_USE_DATE);\n        if (!firstUseDate) {\n          // Primeira vez usando o app\n          firstUseDate = new Date().toISOString();\n          await AsyncStorage.default.setItem(STORAGE_KEYS.FIRST_USE_DATE, firstUseDate);\n          return; // Ainda não é hora de pedir avaliação\n        }\n\n        // Verificar se há data de próxima avaliação agendada\n        const nextReviewDate = await AsyncStorage.default.getItem(STORAGE_KEYS.NEXT_REVIEW_DATE);\n        const now = new Date();\n        if (nextReviewDate) {\n          // Usuário recusou antes, verificar se já passou o tempo\n          const nextDate = new Date(nextReviewDate);\n          if (now >= nextDate) {\n            setShouldShowReview(true);\n          }\n        } else {\n          // Verificar se já passaram 15 dias desde o primeiro uso\n          const firstDate = new Date(firstUseDate);\n          const daysSinceFirstUse = Math.floor((now.getTime() - firstDate.getTime()) / (1000 * 60 * 60 * 24));\n          if (daysSinceFirstUse >= DAYS_BEFORE_FIRST_REVIEW) {\n            setShouldShowReview(true);\n          }\n        }\n      } catch (error) {\n        console.error('Error checking review eligibility:', error);\n      }\n    };\n    const handleReviewAccepted = (0, _react.useCallback)(async () => {\n      try {\n        // Marcar como avaliado permanentemente\n        await AsyncStorage.default.setItem(STORAGE_KEYS.REVIEW_COMPLETED, 'true');\n        setShouldShowReview(false);\n\n        // Tentar abrir a avaliação nativa da loja\n        if (await StoreReview.isAvailableAsync()) {\n          await StoreReview.requestReview();\n        }\n      } catch (error) {\n        console.error('Error handling review:', error);\n      }\n    }, []);\n    const handleReviewDeclined = (0, _react.useCallback)(async () => {\n      try {\n        // Agendar para 30 dias depois\n        const nextDate = new Date();\n        nextDate.setDate(nextDate.getDate() + DAYS_BEFORE_RETRY);\n        await AsyncStorage.default.setItem(STORAGE_KEYS.NEXT_REVIEW_DATE, nextDate.toISOString());\n        setShouldShowReview(false);\n      } catch (error) {\n        console.error('Error scheduling next review:', error);\n      }\n    }, []);\n    const dismissReview = (0, _react.useCallback)(() => {\n      setShouldShowReview(false);\n    }, []);\n\n    // Para testes: resetar o estado de avaliação\n    const resetReviewState = async () => {\n      await AsyncStorage.default.multiRemove([STORAGE_KEYS.FIRST_USE_DATE, STORAGE_KEYS.REVIEW_COMPLETED, STORAGE_KEYS.NEXT_REVIEW_DATE]);\n    };\n    return {\n      shouldShowReview,\n      handleReviewAccepted,\n      handleReviewDeclined,\n      dismissReview,\n      resetReviewState\n    };\n  };\n  _s(useReviewPrompt, \"Ur5ZST0ddcSiM7CX9BEzjxAP/ok=\");\n});","lineCount":132,"map":[[28,2,15,0,"Object"],[28,8,15,0],[28,9,15,0,"defineProperty"],[28,23,15,0],[28,24,15,0,"exports"],[28,31,15,0],[29,4,15,0,"enumerable"],[29,14,15,0],[30,4,15,0,"get"],[30,7,15,0],[30,18,15,0,"get"],[30,19,15,0],[31,6,15,0],[31,13,15,0,"useReviewPrompt"],[31,28,15,0],[32,4,15,0],[33,2,15,0],[34,2,1,0],[34,6,1,0,"_react"],[34,12,1,0],[34,15,1,0,"require"],[34,22,1,0],[34,23,1,0,"_dependencyMap"],[34,37,1,0],[35,2,2,0],[35,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[35,42,2,0],[35,45,2,0,"require"],[35,52,2,0],[35,53,2,0,"_dependencyMap"],[35,67,2,0],[36,2,2,0],[36,6,2,0,"AsyncStorage"],[36,18,2,0],[36,21,2,0,"_interopDefault"],[36,36,2,0],[36,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[36,73,2,0],[37,2,3,0],[37,6,3,0,"_expoStoreReview"],[37,22,3,0],[37,25,3,0,"require"],[37,32,3,0],[37,33,3,0,"_dependencyMap"],[37,47,3,0],[38,2,3,0],[38,6,3,0,"StoreReview"],[38,17,3,0],[38,20,3,0,"_interopNamespace"],[38,37,3,0],[38,38,3,0,"_expoStoreReview"],[38,54,3,0],[39,2,6,0],[39,8,6,6,"STORAGE_KEYS"],[39,20,6,18],[39,23,6,21],[40,4,7,2,"FIRST_USE_DATE"],[40,18,7,16],[40,20,7,18],[40,47,7,45],[41,4,8,2,"REVIEW_COMPLETED"],[41,20,8,18],[41,22,8,20],[41,51,8,49],[42,4,9,2,"NEXT_REVIEW_DATE"],[42,20,9,18],[42,22,9,20],[43,2,10,0],[43,3,10,1],[44,2,12,0],[44,8,12,6,"DAYS_BEFORE_FIRST_REVIEW"],[44,32,12,30],[44,35,12,33],[44,37,12,35],[45,2,13,0],[45,8,13,6,"DAYS_BEFORE_RETRY"],[45,25,13,23],[45,28,13,26],[45,30,13,28],[46,2,15,7],[46,8,15,13,"useReviewPrompt"],[46,23,15,28],[46,26,15,31,"useReviewPrompt"],[46,27,15,31],[46,32,15,37],[47,4,15,37,"_s"],[47,6,15,37],[48,4,16,2],[48,10,16,8],[48,11,16,9,"shouldShowReview"],[48,27,16,25],[48,29,16,27,"setShouldShowReview"],[48,48,16,46],[48,49,16,47],[48,52,16,50],[48,56,16,50,"useState"],[48,62,16,58],[48,63,16,58,"useState"],[48,71,16,58],[48,73,16,59],[48,78,16,64],[48,79,16,65],[49,4,18,2],[49,8,18,2,"useEffect"],[49,14,18,11],[49,15,18,11,"useEffect"],[49,24,18,11],[49,26,18,12],[49,32,18,18],[50,6,19,4,"checkReviewEligibility"],[50,28,19,26],[50,29,19,27],[50,30,19,28],[51,4,20,2],[51,5,20,3],[51,7,20,5],[51,9,20,7],[51,10,20,8],[52,4,22,2],[52,10,22,8,"checkReviewEligibility"],[52,32,22,30],[52,35,22,33],[52,41,22,33,"checkReviewEligibility"],[52,42,22,33],[52,47,22,45],[53,6,23,4],[53,10,23,8],[54,8,24,6],[55,8,25,6],[55,14,25,12,"reviewCompleted"],[55,29,25,27],[55,32,25,30],[55,38,25,36,"AsyncStorage"],[55,50,25,48],[55,51,25,48,"default"],[55,58,25,48],[55,59,25,49,"getItem"],[55,66,25,56],[55,67,25,57,"STORAGE_KEYS"],[55,79,25,69],[55,80,25,70,"REVIEW_COMPLETED"],[55,96,25,86],[55,97,25,87],[56,8,26,6],[56,12,26,10,"reviewCompleted"],[56,27,26,25],[56,32,26,30],[56,38,26,36],[56,40,26,38],[57,10,27,8],[57,17,27,15],[57,18,27,16],[58,8,28,6],[60,8,30,6],[61,8,31,6],[61,12,31,10,"firstUseDate"],[61,24,31,22],[61,27,31,25],[61,33,31,31,"AsyncStorage"],[61,45,31,43],[61,46,31,43,"default"],[61,53,31,43],[61,54,31,44,"getItem"],[61,61,31,51],[61,62,31,52,"STORAGE_KEYS"],[61,74,31,64],[61,75,31,65,"FIRST_USE_DATE"],[61,89,31,79],[61,90,31,80],[62,8,32,6],[62,12,32,10],[62,13,32,11,"firstUseDate"],[62,25,32,23],[62,27,32,25],[63,10,33,8],[64,10,34,8,"firstUseDate"],[64,22,34,20],[64,25,34,23],[64,29,34,27,"Date"],[64,33,34,31],[64,34,34,32],[64,35,34,33],[64,36,34,34,"toISOString"],[64,47,34,45],[64,48,34,46],[64,49,34,47],[65,10,35,8],[65,16,35,14,"AsyncStorage"],[65,28,35,26],[65,29,35,26,"default"],[65,36,35,26],[65,37,35,27,"setItem"],[65,44,35,34],[65,45,35,35,"STORAGE_KEYS"],[65,57,35,47],[65,58,35,48,"FIRST_USE_DATE"],[65,72,35,62],[65,74,35,64,"firstUseDate"],[65,86,35,76],[65,87,35,77],[66,10,36,8],[66,17,36,15],[66,18,36,16],[67,8,37,6],[69,8,39,6],[70,8,40,6],[70,14,40,12,"nextReviewDate"],[70,28,40,26],[70,31,40,29],[70,37,40,35,"AsyncStorage"],[70,49,40,47],[70,50,40,47,"default"],[70,57,40,47],[70,58,40,48,"getItem"],[70,65,40,55],[70,66,40,56,"STORAGE_KEYS"],[70,78,40,68],[70,79,40,69,"NEXT_REVIEW_DATE"],[70,95,40,85],[70,96,40,86],[71,8,41,6],[71,14,41,12,"now"],[71,17,41,15],[71,20,41,18],[71,24,41,22,"Date"],[71,28,41,26],[71,29,41,27],[71,30,41,28],[72,8,43,6],[72,12,43,10,"nextReviewDate"],[72,26,43,24],[72,28,43,26],[73,10,44,8],[74,10,45,8],[74,16,45,14,"nextDate"],[74,24,45,22],[74,27,45,25],[74,31,45,29,"Date"],[74,35,45,33],[74,36,45,34,"nextReviewDate"],[74,50,45,48],[74,51,45,49],[75,10,46,8],[75,14,46,12,"now"],[75,17,46,15],[75,21,46,19,"nextDate"],[75,29,46,27],[75,31,46,29],[76,12,47,10,"setShouldShowReview"],[76,31,47,29],[76,32,47,30],[76,36,47,34],[76,37,47,35],[77,10,48,8],[78,8,49,6],[78,9,49,7],[78,15,49,13],[79,10,50,8],[80,10,51,8],[80,16,51,14,"firstDate"],[80,25,51,23],[80,28,51,26],[80,32,51,30,"Date"],[80,36,51,34],[80,37,51,35,"firstUseDate"],[80,49,51,47],[80,50,51,48],[81,10,52,8],[81,16,52,14,"daysSinceFirstUse"],[81,33,52,31],[81,36,52,34,"Math"],[81,40,52,38],[81,41,52,39,"floor"],[81,46,52,44],[81,47,52,45],[81,48,52,46,"now"],[81,51,52,49],[81,52,52,50,"getTime"],[81,59,52,57],[81,60,52,58],[81,61,52,59],[81,64,52,62,"firstDate"],[81,73,52,71],[81,74,52,72,"getTime"],[81,81,52,79],[81,82,52,80],[81,83,52,81],[81,88,52,86],[81,92,52,90],[81,95,52,93],[81,97,52,95],[81,100,52,98],[81,102,52,100],[81,105,52,103],[81,107,52,105],[81,108,52,106],[81,109,52,107],[82,10,54,8],[82,14,54,12,"daysSinceFirstUse"],[82,31,54,29],[82,35,54,33,"DAYS_BEFORE_FIRST_REVIEW"],[82,59,54,57],[82,61,54,59],[83,12,55,10,"setShouldShowReview"],[83,31,55,29],[83,32,55,30],[83,36,55,34],[83,37,55,35],[84,10,56,8],[85,8,57,6],[86,6,58,4],[86,7,58,5],[86,8,58,6],[86,15,58,13,"error"],[86,20,58,18],[86,22,58,20],[87,8,59,6,"console"],[87,15,59,13],[87,16,59,14,"error"],[87,21,59,19],[87,22,59,20],[87,58,59,56],[87,60,59,58,"error"],[87,65,59,63],[87,66,59,64],[88,6,60,4],[89,4,61,2],[89,5,61,3],[90,4,63,2],[90,10,63,8,"handleReviewAccepted"],[90,30,63,28],[90,33,63,31],[90,37,63,31,"useCallback"],[90,43,63,42],[90,44,63,42,"useCallback"],[90,55,63,42],[90,57,63,43],[90,69,63,55],[91,6,64,4],[91,10,64,8],[92,8,65,6],[93,8,66,6],[93,14,66,12,"AsyncStorage"],[93,26,66,24],[93,27,66,24,"default"],[93,34,66,24],[93,35,66,25,"setItem"],[93,42,66,32],[93,43,66,33,"STORAGE_KEYS"],[93,55,66,45],[93,56,66,46,"REVIEW_COMPLETED"],[93,72,66,62],[93,74,66,64],[93,80,66,70],[93,81,66,71],[94,8,67,6,"setShouldShowReview"],[94,27,67,25],[94,28,67,26],[94,33,67,31],[94,34,67,32],[96,8,69,6],[97,8,70,6],[97,12,70,10],[97,18,70,16,"StoreReview"],[97,29,70,27],[97,30,70,28,"isAvailableAsync"],[97,46,70,44],[97,47,70,45],[97,48,70,46],[97,50,70,48],[98,10,71,8],[98,16,71,14,"StoreReview"],[98,27,71,25],[98,28,71,26,"requestReview"],[98,41,71,39],[98,42,71,40],[98,43,71,41],[99,8,72,6],[100,6,73,4],[100,7,73,5],[100,8,73,6],[100,15,73,13,"error"],[100,20,73,18],[100,22,73,20],[101,8,74,6,"console"],[101,15,74,13],[101,16,74,14,"error"],[101,21,74,19],[101,22,74,20],[101,46,74,44],[101,48,74,46,"error"],[101,53,74,51],[101,54,74,52],[102,6,75,4],[103,4,76,2],[103,5,76,3],[103,7,76,5],[103,9,76,7],[103,10,76,8],[104,4,78,2],[104,10,78,8,"handleReviewDeclined"],[104,30,78,28],[104,33,78,31],[104,37,78,31,"useCallback"],[104,43,78,42],[104,44,78,42,"useCallback"],[104,55,78,42],[104,57,78,43],[104,69,78,55],[105,6,79,4],[105,10,79,8],[106,8,80,6],[107,8,81,6],[107,14,81,12,"nextDate"],[107,22,81,20],[107,25,81,23],[107,29,81,27,"Date"],[107,33,81,31],[107,34,81,32],[107,35,81,33],[108,8,82,6,"nextDate"],[108,16,82,14],[108,17,82,15,"setDate"],[108,24,82,22],[108,25,82,23,"nextDate"],[108,33,82,31],[108,34,82,32,"getDate"],[108,41,82,39],[108,42,82,40],[108,43,82,41],[108,46,82,44,"DAYS_BEFORE_RETRY"],[108,63,82,61],[108,64,82,62],[109,8,83,6],[109,14,83,12,"AsyncStorage"],[109,26,83,24],[109,27,83,24,"default"],[109,34,83,24],[109,35,83,25,"setItem"],[109,42,83,32],[109,43,83,33,"STORAGE_KEYS"],[109,55,83,45],[109,56,83,46,"NEXT_REVIEW_DATE"],[109,72,83,62],[109,74,83,64,"nextDate"],[109,82,83,72],[109,83,83,73,"toISOString"],[109,94,83,84],[109,95,83,85],[109,96,83,86],[109,97,83,87],[110,8,84,6,"setShouldShowReview"],[110,27,84,25],[110,28,84,26],[110,33,84,31],[110,34,84,32],[111,6,85,4],[111,7,85,5],[111,8,85,6],[111,15,85,13,"error"],[111,20,85,18],[111,22,85,20],[112,8,86,6,"console"],[112,15,86,13],[112,16,86,14,"error"],[112,21,86,19],[112,22,86,20],[112,53,86,51],[112,55,86,53,"error"],[112,60,86,58],[112,61,86,59],[113,6,87,4],[114,4,88,2],[114,5,88,3],[114,7,88,5],[114,9,88,7],[114,10,88,8],[115,4,90,2],[115,10,90,8,"dismissReview"],[115,23,90,21],[115,26,90,24],[115,30,90,24,"useCallback"],[115,36,90,35],[115,37,90,35,"useCallback"],[115,48,90,35],[115,50,90,36],[115,56,90,42],[116,6,91,4,"setShouldShowReview"],[116,25,91,23],[116,26,91,24],[116,31,91,29],[116,32,91,30],[117,4,92,2],[117,5,92,3],[117,7,92,5],[117,9,92,7],[117,10,92,8],[119,4,94,2],[120,4,95,2],[120,10,95,8,"resetReviewState"],[120,26,95,24],[120,29,95,27],[120,35,95,27,"resetReviewState"],[120,36,95,27],[120,41,95,39],[121,6,96,4],[121,12,96,10,"AsyncStorage"],[121,24,96,22],[121,25,96,22,"default"],[121,32,96,22],[121,33,96,23,"multiRemove"],[121,44,96,34],[121,45,96,35],[121,46,97,6,"STORAGE_KEYS"],[121,58,97,18],[121,59,97,19,"FIRST_USE_DATE"],[121,73,97,33],[121,75,98,6,"STORAGE_KEYS"],[121,87,98,18],[121,88,98,19,"REVIEW_COMPLETED"],[121,104,98,35],[121,106,99,6,"STORAGE_KEYS"],[121,118,99,18],[121,119,99,19,"NEXT_REVIEW_DATE"],[121,135,99,35],[121,136,100,5],[121,137,100,6],[122,4,101,2],[122,5,101,3],[123,4,103,2],[123,11,103,9],[124,6,104,4,"shouldShowReview"],[124,22,104,20],[125,6,105,4,"handleReviewAccepted"],[125,26,105,24],[126,6,106,4,"handleReviewDeclined"],[126,26,106,24],[127,6,107,4,"dismissReview"],[127,19,107,17],[128,6,108,4,"resetReviewState"],[129,4,109,2],[129,5,109,3],[130,2,110,0],[130,3,110,1],[131,2,110,2,"_s"],[131,4,110,2],[131,5,15,13,"useReviewPrompt"],[131,20,15,28],[132,0,15,28],[132,3]],"functionMap":{"names":["<global>","useReviewPrompt","useEffect$argument_0","checkReviewEligibility","handleReviewAccepted","handleReviewDeclined","dismissReview","resetReviewState"],"mappings":"AAA;+BCc;YCG;GDE;iCEE;GFuC;2CGE;GHa;2CIE;GJU;oCKE;GLE;2BMG;GNM;CDS"},"hasCjsExports":false},"type":"js/module"}]}